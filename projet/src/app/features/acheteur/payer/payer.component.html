<div class="payer-container">
  <div class="container">
    <div class="page-header">
      <button class="btn-back" (click)="retourCommandes()">
        <i class="fas fa-arrow-left"></i>
      </button>
      <h1><i class="fas fa-credit-card"></i> Paiement</h1>
    </div>

    <!-- Loading -->
    <div class="loading-state" *ngIf="loading">
      <i class="fas fa-spinner fa-spin"></i>
      <p>Chargement de la commande...</p>
    </div>

    <!-- Error -->
    <div class="error-message" *ngIf="errorMessage && !loading">
      <i class="fas fa-exclamation-circle"></i>
      {{ errorMessage }}
      <button class="btn btn-secondary" (click)="retourCommandes()">
        Retour aux commandes
      </button>
    </div>

    <!-- Success -->
    <div class="success-message" *ngIf="successMessage">
      <i class="fas fa-check-circle"></i>
      {{ successMessage }}
    </div>

    <!-- Payment Form -->
    <div class="payment-content" *ngIf="!loading && !errorMessage && commande && !successMessage">
      <!-- Order Summary -->
      <div class="order-summary-card">
        <h2>Récapitulatif de la commande</h2>
        
        <div class="order-info">
          <div class="info-row">
            <span class="label">Commande:</span>
            <span class="value">{{ commande.numero_commande }}</span>
          </div>
          <div class="info-row">
            <span class="label">Boutique:</span>
            <span class="value">{{ commande.boutique?.nom }}</span>
          </div>
          <div class="info-row">
            <span class="label">Statut:</span>
            <span class="value status-badge" [ngClass]="'status-' + commande.statut">
              {{ getStatutLabel(commande.statut) }}
            </span>
          </div>
        </div>

        <div class="order-total">
          <span>Total à payer:</span>
          <span class="amount">{{ commande.total_general | number:'1.2-2' }} €</span>
        </div>
      </div>

      <!-- Payment Method Selection -->
      <div class="payment-method-card">
        <h3>Choisir le mode de paiement</h3>
        
        <form [formGroup]="paiementForm" (ngSubmit)="onSubmit()">
          <div class="payment-options">
            <label class="payment-option" *ngFor="let methode of methodesPaiement"
                   [class.selected]="paiementForm.get('methode_paiement')?.value === methode.value">
              <input type="radio" formControlName="methode_paiement" [value]="methode.value">
              <i class="fas {{ methode.icon }}"></i>
              <span>{{ methode.label }}</span>
            </label>
          </div>

          <div class="payment-actions">
            <button type="button" class="btn btn-secondary" (click)="retourCommandes()">
              Annuler
            </button>
            <button type="submit" class="btn btn-primary" [disabled]="submitting">
              <i class="fas" [class.fa-spinner]="submitting" [class.fa-spin]="submitting"></i>
              {{ submitting ? 'Paiement en cours...' : 'Confirmer le paiement' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
