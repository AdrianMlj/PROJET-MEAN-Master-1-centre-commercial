<div class="admin-layout">
  <!-- Sidebar - FIXE -->
  <aside class="sidebar" [class.collapsed]="isCollapsed" [class.active]="isMobileMenuOpen">
    <div class="sidebar-header">
      <div class="logo">
        <i class="fas fa-store-alt"></i>
        <span *ngIf="!isCollapsed">ONLINE SHOP</span>
      </div>
      <button class="toggle-btn" (click)="toggleSidebar()" [attr.aria-label]="isCollapsed ? 'Étendre' : 'Réduire'">
        <i class="fas" [class.fa-chevron-left]="!isCollapsed" [class.fa-chevron-right]="isCollapsed"></i>
      </button>
    </div>

    <!-- Profil administrateur - AVEC AVATAR -->
    <div class="admin-profile" *ngIf="!isCollapsed">
      <div class="avatar">
        <img [src]="getAvatarUrl()" 
             [alt]="getCurrentAdminName()"
             (error)="onAvatarError($event)"
             class="avatar-img">
      </div>
      <div class="info">
        <h4>{{ getCurrentAdminName() }}</h4>
        <span class="badge">Administrateur</span>
      </div>
    </div>

    <!-- Version mobile du profil - AVEC AVATAR -->
    <div class="admin-profile-mobile" *ngIf="isCollapsed" title="{{ getCurrentAdminName() }}">
      <div class="avatar">
        <img [src]="getAvatarUrl()" 
             [alt]="getCurrentAdminName()"
             (error)="onAvatarError($event)"
             class="avatar-img">
      </div>
    </div>

    <!-- Navigation -->
    <nav class="sidebar-nav">
      <!-- Dashboard -->
      <a routerLink="/admin/dashboard" routerLinkActive="active" class="nav-item">
        <i class="fas fa-tachometer-alt"></i>
        <span *ngIf="!isCollapsed">Dashboard</span>
      </a>

      <!-- Gestion Boutiques -->
      <div class="nav-section">
        <div class="nav-header" (click)="toggleMenu('gestionBoutiques')" [class.active]="menuOpen['gestionBoutiques']">
          <i class="fas fa-store"></i>
          <span *ngIf="!isCollapsed">Gestion Boutiques</span>
          <i *ngIf="!isCollapsed" class="fas" 
             [class.fa-chevron-down]="menuOpen['gestionBoutiques']"
             [class.fa-chevron-right]="!menuOpen['gestionBoutiques']"></i>
        </div>
        
        <!-- Sous-menu CATÉGORIES -->
        <div class="sub-menu" *ngIf="menuOpen['gestionBoutiques']">
          <div class="sub-header" (click)="toggleMenu('categories')" [class.active]="menuOpen['categories']">
            <i class="fas fa-tags"></i>
            <span *ngIf="!isCollapsed">Catégories</span>
            <i *ngIf="!isCollapsed" class="fas" 
               [class.fa-chevron-down]="menuOpen['categories']"
               [class.fa-chevron-right]="!menuOpen['categories']"></i>
          </div>
          
          <div class="sub-sub-menu" *ngIf="menuOpen['categories']">
            <a routerLink="/admin/boutiques/categories/creer" 
               routerLinkActive="active" 
               class="sub-item">
              <i class="fas fa-plus-circle"></i>
              <span *ngIf="!isCollapsed">Créer catégorie</span>
            </a>
            <a routerLink="/admin/boutiques/categories/liste" 
               routerLinkActive="active" 
               class="sub-item">
              <i class="fas fa-list"></i>
              <span *ngIf="!isCollapsed">Listes catégories</span>
            </a>
          </div>

          <!-- Sous-menu BOUTIQUES -->
          <div class="sub-header" (click)="toggleMenu('boutiques')" [class.active]="menuOpen['boutiques']">
            <i class="fas fa-store"></i>
            <span *ngIf="!isCollapsed">Boutiques</span>
            <i *ngIf="!isCollapsed" class="fas" 
               [class.fa-chevron-down]="menuOpen['boutiques']"
               [class.fa-chevron-right]="!menuOpen['boutiques']"></i>
          </div>
          
          <div class="sub-sub-menu" *ngIf="menuOpen['boutiques']">
            <a routerLink="/admin/boutiques/boutiques/creer" 
               routerLinkActive="active" 
               class="sub-item">
              <i class="fas fa-plus-circle"></i>
              <span *ngIf="!isCollapsed">Création boutique</span>
            </a>
            <a routerLink="/admin/boutiques/boutiques/liste" 
               routerLinkActive="active" 
               class="sub-item">
              <i class="fas fa-list"></i>
              <span *ngIf="!isCollapsed">Listes boutiques</span>
            </a>
          </div>
        </div>
      </div>

      <!-- Gestion Utilisateurs -->
      <div class="nav-section">
        <div class="nav-header" (click)="toggleMenu('gestionUtilisateurs')" [class.active]="menuOpen['gestionUtilisateurs']">
          <i class="fas fa-users"></i>
          <span *ngIf="!isCollapsed">Gestion Utilisateurs</span>
          <i *ngIf="!isCollapsed" class="fas" 
             [class.fa-chevron-down]="menuOpen['gestionUtilisateurs']"
             [class.fa-chevron-right]="!menuOpen['gestionUtilisateurs']"></i>
        </div>
        
        <!-- Sous-menu Utilisateurs -->
        <div class="sub-menu" *ngIf="menuOpen['gestionUtilisateurs']">
          <a routerLink="/admin/utilisateurs/creer-boutique" 
             routerLinkActive="active" 
             class="sub-item">
            <i class="fas fa-user-plus"></i>
            <span *ngIf="!isCollapsed">Création compte boutique</span>
          </a>
          <a routerLink="/admin/utilisateurs/liste" 
             routerLinkActive="active" 
             class="sub-item">
            <i class="fas fa-list"></i>
            <span *ngIf="!isCollapsed">Listes de tous les utilisateurs</span>
          </a>
        </div>
      </div>

      <!-- Notifications -->
    <div class="nav-section">
      <div class="nav-header" routerLink="/admin/notifications" routerLinkActive="active">
        <i class="fas fa-bell"></i>
        <span *ngIf="!isCollapsed">Notifications</span>
        <span class="badge-notification" *ngIf="notificationCount > 0">{{ notificationCount }}</span>
      </div>
    </div>

      <!-- Statistiques -->
      <div class="nav-section">
        <div class="nav-header" routerLink="/admin/statistiques" routerLinkActive="active">
          <i class="fas fa-chart-line"></i>
          <span *ngIf="!isCollapsed">Statistiques</span>
        </div>
      </div>

      <!-- Profil -->
    <div class="nav-section">
      <div class="nav-header" routerLink="/admin/profil" routerLinkActive="active">
        <i class="fas fa-user-cog"></i>
        <span *ngIf="!isCollapsed">Mon profil</span>
      </div>
    </div>
      
      <!-- Espace pour le scroll -->
      <div class="nav-footer-space"></div>
    </nav>

    <!-- Footer avec bouton déconnexion -->
    <div class="sidebar-footer">
      <button class="nav-item logout-btn" (click)="logout()" [title]="isCollapsed ? 'Déconnexion' : ''">
        <i class="fas fa-sign-out-alt"></i>
        <span *ngIf="!isCollapsed">Déconnexion</span>
      </button>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content" [class.expanded]="isCollapsed">
    <router-outlet></router-outlet>
  </main>
  
  <!-- Overlay mobile -->
  <div class="mobile-overlay" *ngIf="isMobileMenuOpen" (click)="toggleMobileMenu()"></div>
</div>